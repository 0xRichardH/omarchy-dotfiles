# Plan: System-wide Ctrl+HJKL Arrow Key Navigation

## Overview
Add system-wide keyboard remapping to use Ctrl+H/J/K/L as left/down/up/right arrow keys across all applications on Arch Linux.

## Implementation Approach

### Solution: Extend xremap configuration
Use the existing xremap setup (already active via systemd) to add a new modmap entry. This provides system-wide key remapping that works in all applications.

**Rationale:**
- xremap is already installed, configured, and running as a systemd service
- modmap section is perfect for modifier+key → arrow key remapping
- System-wide scope means it works everywhere (browsers, terminals, editors, etc.)
- No conflicts with existing config (only maps Ctrl_L alone → Esc)

## Files to Modify

### 1. `xremap/.config/xremap/config.yml`
**Current state:** Contains single modmap entry for Ctrl_L dual-function (Esc when alone, Ctrl when held)

**Change:** Add new modmap entry for Ctrl+HJKL → arrow keys

**New configuration:**
```yaml
modmap:
  - name: Ctrl_L as Ctrl/Esc
    remap:
      Ctrl_L:
        alone: Esc
        held: Ctrl_L
  
  - name: Ctrl+HJKL as Arrow Keys
    remap:
      C-h: left
      C-j: down
      C-k: up
      C-l: right
```

**Key details:**
- `C-h` syntax means Ctrl+H (works with both left and right Ctrl by default)
- Vim-style navigation: H=left, J=down, K=up, L=right
- 2-space indentation per YAML style guide
- Maps to actual arrow key events (left/down/up/right)

## Deployment Steps

### 1. Test configuration syntax (dry-run)
```bash
stow --target=$HOME --simulate xremap
```
Expected: No conflicts or errors

### 2. Apply the configuration
```bash
stow --target=$HOME --restow xremap
```
This creates/updates symlink: `~/.config/xremap/config.yml` → dotfiles path

### 3. Restart xremap service
```bash
systemctl --user restart xremap.service
```

### 4. Verify service status
```bash
systemctl --user status xremap.service
```
Expected: `active (running)` with no errors

### 5. Check logs for issues
```bash
journalctl --user -u xremap.service -b -n 50 --no-pager
```
Look for successful config reload or any parsing errors

## Verification Plan

### Manual Testing
Test in multiple application contexts:

1. **Browser (Firefox/Chrome)**
   - Open any text field
   - Press Ctrl+H → cursor should move left
   - Press Ctrl+J → cursor should move down (or to next line)
   - Press Ctrl+K → cursor should move up (or to previous line)
   - Press Ctrl+L → cursor should move right

2. **Terminal (Alacritty)**
   - Type a command, move cursor with Ctrl+H/L
   - Navigate command history with Ctrl+J/K (if line-editing supports vertical movement)
   - Note: Some terminal apps may intercept these keys, which is expected behavior

3. **Text editor (not vim)**
   - Open any GUI text editor (e.g., gedit, VSCode)
   - Test navigation with Ctrl+HJKL
   - Should work like arrow keys

4. **File manager**
   - Open file browser
   - Test if Ctrl+HJKL navigates file list
   - Expected: Works as arrow keys

### Rollback Plan
If the configuration causes issues:

1. Check logs: `journalctl --user -u xremap.service -f`
2. Revert the config change in `xremap/.config/xremap/config.yml`
3. Restart service: `systemctl --user restart xremap.service`
4. Or temporarily disable: `systemctl --user stop xremap.service`

## Dependencies
- xremap-x11-bin (already installed)
- xremap.service (already running)
- User in `input` group (already configured)
- uinput kernel module (already loaded)

## Commit Plan
After successful testing:
```
feat(xremap): add Ctrl+HJKL arrow key navigation

Add system-wide vim-style navigation using Ctrl+H/J/K/L as arrow keys.
Maps work across all applications via xremap modmap configuration.
```

## Notes
- This mapping works globally and may override application-specific Ctrl+H/J/K/L shortcuts
- Most applications should handle this gracefully as arrow key events
- Vim/Neovim users: These keys will behave as arrow keys even in insert mode
- The existing Ctrl_L dual-function mapping (Esc when alone) remains unchanged
